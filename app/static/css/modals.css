/* --- 自定义移动端底部动作面板 (Action Sheet) --- */
.mobile-sheet-overlay {
    position: fixed; inset: 0;
    background: rgba(0,0,0,.4);
    opacity: 0; visibility: hidden;
    transition: opacity .3s ease, visibility 0s .3s;
    z-index: 200;
}
.mobile-sheet-overlay.visible {
    opacity: 1; visibility: visible;
    transition: opacity .3s ease;
}

.mobile-sheet-panel {
    position: fixed; left: 0; right: 0; bottom: 0;
    background: var(--panel);
    border-top: 1px solid var(--border);
    border-radius: var(--radius-l) var(--radius-l) 0 0;
    box-shadow: var(--shadow-2);
    z-index: 201;
    transform: translateY(100%);
    transition: transform .3s cubic-bezier(0.2, 0, 0, 1);
    max-height: 75vh;
    display: flex; flex-direction: column;
}
.mobile-sheet-panel.visible { transform: translateY(0); }

.mobile-sheet-header {
    font-size: 14px; font-weight: 600; color: var(--muted);
    padding: 16px 20px;
    border-bottom: 1px solid var(--border);
    text-align: center;
}
.mobile-sheet-content {
    overflow-y: auto; padding: 8px;
}
.mobile-menu-item {
    padding: 16px 20px; font-size: 16px;
    cursor: pointer; border-radius: var(--radius-s);
    color: var(--text);
}
.mobile-menu-item:active { background: color-mix(in srgb, var(--text) 10%, transparent); }
.mobile-menu-item.danger { color: var(--danger); }

.mobile-sheet-group { padding: 8px; border-bottom: 1px solid var(--border); }
.mobile-sheet-group:last-child { border-bottom: none; }
.mobile-sheet-label {
    font-size: 13px; font-weight: 600; color: var(--muted);
    padding: 8px 8px 4px;
}

/* 移动端模型网格 */
.model-menu.mobile {
    display: flex; flex-wrap: wrap; flex-direction: row; gap: 8px;
}
.model-menu.mobile .model-item {
    padding: 10px;
    flex-grow: 1; flex-basis: 140px; /* 双列布局 */
    background: var(--bg);
    border: 1px solid var(--border);
}
.model-menu.mobile .model-item.active {
    background: color-mix(in srgb, var(--accent) 10%, var(--panel));
    border-color: var(--accent);
}

/* --- Shoelace 组件全局覆盖 --- */

/* 统一圆角与背景 */
sl-dialog::part(panel) {
    border-radius: var(--radius-l);
    background-color: var(--panel);
    color: var(--text);
    border: 1px solid var(--border);
    box-shadow: var(--shadow-2);
}
sl-dialog::part(header), sl-dialog::part(body), sl-dialog::part(footer) {
    background-color: transparent;
    color: var(--text);
}
sl-dialog::part(header) { border-bottom-color: var(--border); }
sl-dialog::part(title) { font-weight: 600; }
sl-dialog::part(overlay) { background-color: rgba(0,0,0,0.4); }

/* 输入框适配 */
sl-input::part(base) {
    border-radius: var(--radius-s);
    background-color: var(--bg);
    border-color: var(--border);
    color: var(--text);
}
sl-input::part(input) { color: var(--text); }
sl-input:focus-within::part(base) {
    border-color: var(--accent);
    box-shadow: 0 0 0 2px color-mix(in srgb, var(--accent) 20%, transparent);
}

/* Toast 提示 */
sl-alert::part(base) {
    border-radius: var(--radius-m);
    box-shadow: var(--shadow-2);
    background-color: var(--panel);
    color: var(--text);
    border: 1px solid var(--border);
}

/* 深色模式 Shoelace 覆盖 */
:root[data-theme="dark"] sl-menu-item::part(base):hover,
:root[data-theme="dark"] sl-menu-item::part(base):focus {
    background-color: color-mix(in srgb, var(--text) 10%, transparent);
    color: var(--text);
}
:root[data-theme="dark"] sl-menu-item[checked]::part(base) {
    background-color: color-mix(in srgb, var(--accent) 20%, transparent);
    color: var(--accent);
}

/* 降级 Toast 样式 (当 Shoelace 未加载时) */
sl-alert.toast-fallback[open] {
    position: fixed; top: 24px; right: 24px;
    z-index: 999;
    max-width: 360px;
    background: var(--panel);
    padding: 16px; border-radius: var(--radius-m);
    box-shadow: var(--shadow-2);
    border: 1px solid var(--border);
    display: flex; gap: 12px; align-items: center;
}